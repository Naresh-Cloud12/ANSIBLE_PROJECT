# ANSIBLE_PROJECT
Provisioning + Configuration Management


Task - 1
task one will be to use anible control node where the control node will be our laptop which has anible installed already. using the anible that we have installed first task that we will do is provisioning...anible can be used for configuration management anible can be used for Network appliances 
step one we will be using anible for provisioning and where are we going to provision the resources we are going to provision on AWS AWS is a control plane AWS is a is platform so here you cannot connect anible with AWS using SSH... because it's not a server AWS is a IAM platform or the PaaS platform what you need to do you need to use ansible AWS collection and in the anible AWS collection you will have a module for ec2 we will be using that module and that module will be run on the control node so usual practice is that if you're using anible for configuration management you will connect to your manage node or the server and you will SSH to that machine and execute the anible module on that machine but here we are doing provisioning you cannot SSH to AWS so we will use connection type as local and we will run the module on the anible control node itself  
this module which is a python module using boto3 it will connect to the AWS API and it will provision the ec2 instances for us ----So this is the TASK 1

Task -2 (Passwordless Authentication) 
start with the AWS account because we need to create a iAm user if Aws has to talk to the APT of the AWS you need authentication to connect to AWS . you need authentication to connect to AWS.Both of the  modules need to talk to the AWS API for that we will create a im user and we will provide the access token and secret key to the ansible.
IN Aws console--IM service click on the users let's create a user let's call it as anible  user provide user access to the AWS Management console it's not required add user to group copy permissions attach policies directly let's attach the policies directly let's search for ec2 okay these are all ec2 let me Grant ec2 full access to it okay perfect but if you want to find tune and give the required permissions you can do that as well ---This is a IAM User Now
security credentials--- Create access key application running outside AWS okay Now we got the Access Key and Secret Key...
 Now lets go to the visual studio We need two extension YAML Extension(for better yaml files),Ansible its provided by RedHat..Now create a folder name it like as it is github going to commit these playbooks that I'm going to write to the GitHub repository  ...prerequisites yes there are some more prerequisites ---first you need to install boto 3  ---pip install boto3---Then Install AWS Collection=---ansible-galaxy collection install amazon.aws--Now setup Vault---Create a password for vault ---openssl rand -base64 2048 > vault.pass((((I'll not be editing first I have to create so anible Vault within the anible Vault I'm going to create a file which is called pass yaml or password. yaml whatever you want to name it and I'm protecting the the data in the password. yaml using the encoded    *so anybody who wants to access this they need to have this Bas 64 encoded file otherwise they cannot access it* ----Add your AWS credentials using the below vault command--------ansible-vault create group_vars/all/pass.yml --vault-password-file vault.pass---------when you have some sensitive information like the API tokens or the passwords or TLS files any secure templates you need to make sure that you put them in the vault anible VA is very simple and straightforward it comes with the outof thee box and ansible installation ...

 first let's create this and within this let's try to store our access key and secret access key so let's call this as EC2 undercore accessor key copy it and let's call this E2 underscore secret undescore key this is sensitive you should not share this with anyone ..
 I've saved the file now I have the AWS API keys to access AWS and create ec2 to instances now my anible can talk to the AWS API's because we have given the IM user permissions to create ec2 instances with this I am user if you try to create S3 bucket anible cannot do that because we just granted EC2 instance permission okay now what else
 Now Lets start with creating a file --EC2_Create.yaml----We are playbook files so start with three hyphin(---) 
 write the host in this case the host will be Local Host why because what we are doing is we are executing the anable module on the control node itself because it's a provisioning task you cannot SSH to AWS so we will set the connection type as local and we will also say the host as local so connection local now we can start writing the task but how to write it let's say you don't know how to use 
 Google search for anible AWS collection and because we have already installed the anable AWS collection in the prerequisite section just scroll down search for what module you want to use I want to use e C2 instance module
 so I have two things that need to vary what I can simply do is I can just copy this task put this three times right this will also solve my purpose and here I will say anible instance I'll say anible instance one I'll say anable instance two and similarly I will also update the Ami IDs but the problem with this approach is I am not doing a standard programming in any programming language you have the concept called as loops  --- ![image](https://github.com/user-attachments/assets/503cdbad-14cc-4204-b871-217e0dc8721e)
put Loop okay and within the loop you can just say a image ID for example okay I'll say image ID 1 image ID 2 this is the syntax that's it and I will say image ID 3 I'll copy these image IDs how how can I get them again just go to your E2 section E2 dashboard search for ![image](https://github.com/user-attachments/assets/12464b21-f538-4273-8e7f-f3aff8965f68)he instances click on the launch instance and here what you can do Amazon Linux so you get the Ami ID here so first instance that I'll create is Amazon Linux then let me pick up uban 2 here copy the Ami ID and copy the Ami ID I mean it will perform this particular task three times and each time it will use the items that you have provided  ----but where will it replace this Ami ID wherever it has to replace just go to that particular Point inside the double code use two double curly brackets which is for the ginger to templating and just write item  ![image](https://github.com/user-attachments/assets/95a33631-9793-4851-a95f-70cdff512f76) 
now this Loop will understand that it has to take the Ami ID replace the item with it and execute this task again second time replace with it and execute third time replace with it and execute .
created now this is the tricky part like I've explained in the interview the reason why interviewer said two of your instances right if you look at the question carefully two of the instances has to of the type ubu it is done purposefully because interviewer is trying to understand if you know the item potency nature of anible or not so there is a difference between using shell scripts and using anible that is anible comes with idem potency what does that mean that means if you're running same thing with anible two times first anible will execute it second time anible will not execute it saying that the same state is already available on the target 
if you compare this with shell scripting let's say in your shell script you run this command touch AB which is basically used to create a file called Abby you run it first time shell script will create a file called Abby run it second time again shell script will try to create a file called Abby and your shell command will fail saying that file already exists ----but this is not the case--
in anible anible has a feature called as idem potency where if you try to create the file for the first time it will create second time it will not fail it will simply ignore the task because the file is already available on that Target it did the same thing------this is the tricky part which interviewer was looking for ------

![image](https://github.com/user-attachments/assets/912e36e5-1553-4adc-a184-90f0d6d8bea7)
Now understand this we need to make some changes --we will do is just like how we have written the image ID in the loop we can also write the name in the loop so what I'm going to do in this Loop I'm slightly going to change it and I'm going to use this syntax where in inside this brackets we are trying to do here is instead of using one variable in the loop now we are using two variable and here instead of just calling item I will say item.Image(dot)  but instead of anible instance I'll just say item.name(dot)    ===what now Loop will do whenever it sees item. image it will replace with this image and whenever it sees item. name it will replace with this one for the first time .Now if wr run this it should show three instance still not showing so we need add tags  ![image](https://github.com/user-attachments/assets/7bb0ee9c-f683-4aad-9c53-a3aef8b068ae)
I just added this one more section exactly the same instead of name here I have added tags and in the environment I said item. name so now if you go to the AWS console you can see three manage nodes  ---what interviewer was expecting you to explain that you know when you provide the same Ami ID because of the anbl item potency nature it couldn't create three instances so I have added the tag and I am using the loop here as well you can use not just for the tags you can use loops on any default field it will differ from the existing ec2 nstance for anible and it will create a new instance for you perfect anyways this did the trick for us using tags envirment okay now three instances are created our first task is done...

---let's set up passwordless authentication--

 



 

